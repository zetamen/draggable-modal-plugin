"use strict";!function(o){o.add("plugin","draggablemodal",{init:function(t){this.app=t,this.$doc=o.dom(document),this.modal=null,this.modalShift={x:0,y:0},this.mouseModalOffset={top:0,right:0,bottom:0,left:0}},onmodal:{opened:function(t){var o=(this.modal=t).getHeader();o.css("cursor","move"),o.on("mousedown.redactor.modal",this._dragStartHandler.bind(this))},closed:function(t){t.getHeader().off("mousedown"),this.modal=null}},_dragStartHandler:function(t){var o=this.modal.get().getBoundingClientRect();this.mouseModalOffset={top:t.clientY-o.top,right:o.right-t.clientX,bottom:o.bottom-t.clientY,left:t.clientX-o.left},this.modalShift={x:t.clientX-parseInt(this.modal.css("margin-left")),y:t.clientY-parseInt(this.modal.css("margin-top"))},this.$doc.on("mousemove.redactor.modal",this._dragHandler.bind(this)),this.$doc.on("mouseup.redactor.modal",this._dragEndHandler.bind(this))},_dragHandler:function(t){var o=this.$doc.get().documentElement;0<this.mouseModalOffset.left&&0<t.clientX-this.mouseModalOffset.left&&0<this.mouseModalOffset.right&&t.clientX+this.mouseModalOffset.right<o.clientWidth&&this.modal.css("margin-left",t.clientX-this.modalShift.x+"px"),0<this.mouseModalOffset.top&&0<t.clientY-this.mouseModalOffset.top&&0<this.mouseModalOffset.bottom&&t.clientY+this.mouseModalOffset.bottom<o.clientHeight-16&&this.modal.css("margin-top",t.clientY-this.modalShift.y+"px")},_dragEndHandler:function(){this.$doc.off("mousemove.redactor.modal"),this.$doc.off("mouseup.redactor.modal")}})}(Redactor);